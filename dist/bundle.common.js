!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.VFolder=t()}(this,function(){"use strict";function e(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function t(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"!==r.join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(e){a[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(e){return!1}}function n(e,t){return t={exports:{}},e(t,t.exports),t.exports}function r(e,t,n,a){void 0===e&&(e={});var o=t.node,i=t.branch,c=t.leaf,s=t.checked,f=t.open,u=e[o]||"/",d=e[i]||[],l=e[c]||[],h=d.length>0||l.length>0;a=a||"/"+u,d=d.map(function(e,o){return r(e,t,n+"."+o,a+"/"+e.name)}),l=l.map(function(e,t){return{name:e,type:"leaf",checked:s,level:n+"."+t,path:a+"/"+e}});var p=h?"filled":"empty";return{name:u,type:"branch",level:n,path:a,node:{name:u,open:f,canOpen:h,checked:s,level:n,path:a,type:"node",status:p},branches:d,leafs:l}}var a={methods:{notify:function(e){this.___vemit(e,this.data)},listen:function(e,t){this.___von(e,function(e){t(e)})}},destroyed:function(){this.___voff()}},o=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,s=t()?Object.assign:function(t,n){for(var r,a,s=arguments,f=e(t),u=1;u<arguments.length;u++){r=Object(s[u]);for(var d in r)i.call(r,d)&&(f[d]=r[d]);if(o){a=o(r);for(var l=0;l<a.length;l++)c.call(r,a[l])&&(f[a[l]]=r[a[l]])}}return f},f="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},u=n(function(e){var t=function(){function e(t,n,r,a,f){function u(t,r){if(null===t)return null;if(0===r)return t;var p,v;if("object"!=typeof t)return t;if(t instanceof i)p=new i;else if(t instanceof c)p=new c;else if(t instanceof s)p=new s(function(e,n){t.then(function(t){e(u(t,r-1))},function(e){n(u(e,r-1))})});else if(e.__isArray(t))p=[];else if(e.__isRegExp(t))p=new RegExp(t.source,o(t)),t.lastIndex&&(p.lastIndex=t.lastIndex);else if(e.__isDate(t))p=new Date(t.getTime());else{if(h&&Buffer.isBuffer(t))return p=new Buffer(t.length),t.copy(p),p;t instanceof Error?p=Object.create(t):"undefined"==typeof a?(v=Object.getPrototypeOf(t),p=Object.create(v)):(p=Object.create(a),v=a)}if(n){var b=d.indexOf(t);if(b!=-1)return l[b];d.push(t),l.push(p)}if(t instanceof i)for(var m=t.keys();;){var y=m.next();if(y.done)break;var g=u(y.value,r-1),j=u(t.get(y.value),r-1);p.set(g,j)}if(t instanceof c)for(var O=t.keys();;){var y=O.next();if(y.done)break;var k=u(y.value,r-1);p.add(k)}for(var w in t){var _;v&&(_=Object.getOwnPropertyDescriptor(v,w)),_&&null==_.set||(p[w]=u(t[w],r-1))}if(Object.getOwnPropertySymbols)for(var x=Object.getOwnPropertySymbols(t),w=0;w<x.length;w++){var P=x[w],S=Object.getOwnPropertyDescriptor(t,P);(!S||S.enumerable||f)&&(p[P]=u(t[P],r-1),S.enumerable||Object.defineProperty(p,P,{enumerable:!1}))}if(f)for(var E=Object.getOwnPropertyNames(t),w=0;w<E.length;w++){var q=E[w],S=Object.getOwnPropertyDescriptor(t,q);S&&S.enumerable||(p[q]=u(t[q],r-1),Object.defineProperty(p,q,{enumerable:!1}))}return p}"object"==typeof n&&(r=n.depth,a=n.prototype,f=n.includeNonEnumerable,n=n.circular);var d=[],l=[],h="undefined"!=typeof Buffer;return"undefined"==typeof n&&(n=!0),"undefined"==typeof r&&(r=1/0),u(t,r)}function t(e){return Object.prototype.toString.call(e)}function n(e){return"object"==typeof e&&"[object Date]"===t(e)}function r(e){return"object"==typeof e&&"[object Array]"===t(e)}function a(e){return"object"==typeof e&&"[object RegExp]"===t(e)}function o(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}var i;try{i=Map}catch(e){i=function(){}}var c;try{c=Set}catch(e){c=function(){}}var s;try{s=Promise}catch(e){s=function(){}}return e.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},e.__objToStr=t,e.__isDate=n,e.__isArray=r,e.__isRegExp=a,e.__getRegExpFlags=o,e}();e.exports&&(e.exports=t)}),d=[].push,l=function(e){return e},h={node:"name",branch:"dirs",leaf:"files",open:!1,checked:!1},p=function(e,t){var n=e.path||e.name,a=n.split("/").filter(function(e){return!!e}).slice(-1)[0]||e.name;e.name=a,this.conf=s({},t,h),this.dataStore=r(e,this.conf,"0",n)};p.prototype.replace=function(e){this.dataStore=e},p.prototype.findParentBranch=function(e){void 0===e&&(e="");var t=e.length,n=this.dataStore;if(t<=1)return null;for(var r=e.split(".").slice(1,-1),a=0;n&&(a=r.shift());)n=n.branches[a];return n},p.prototype.findCurrentBranch=function(e){void 0===e&&(e="");for(var t=e.split(".").slice(1),n=0,r=this.dataStore;r&&(n=t.shift());)r=r.branches[n];return r},p.prototype.checkBranchAscendents=function(e,t){var n=!1;if(e){if(t){var r=!e.branches.some(function(e){return!e.node.checked}),a=!e.leafs.some(function(e){return!e.checked});n=r&&a}e.node.checked=n,this.checkBranchAscendents(this.findParentBranch(e.level),n)}},p.prototype.checkBranchDescendents=function(e,t){var n=this;e.node.checked=t,e.leafs.forEach(function(e){return e.checked=t}),e.branches.forEach(function(e){e.node.checked=t,n.checkBranchDescendents(e,t)})},p.prototype.checkNode=function(e){var t=this.findCurrentBranch(e.level),n=!t.node.checked;this.checkBranchDescendents(t,n),this.checkBranchAscendents(this.findParentBranch(t.level),n)},p.prototype.checkLeaf=function(e){var t=this.findParentBranch(e.level),n=!e.checked;e.checked=n,this.checkBranchAscendents(t,n)},p.prototype.merge=function(e,t){void 0===e&&(e={}),void 0===t&&(t={level:"0",path:""});var n=t.level,a=t.path,o=t.checked,i=n.split(".").slice(1),c=r(e,this.conf,n,a);if(c.node.open=!0,c.node.checked=o,c.node.status="done",0===i.length)this.replace(c);else{for(var s=u(this.dataStore),f=s,d=i.pop(),l=0;l=i.shift();)f=f.branches[l];f.branches.splice(d,1,c),f.node.canOpen=!0,this.replace(s)}this.checkBranchDescendents(c,o)},p.prototype.commit=function(e,t,n){void 0===n&&(n=l);var r="node"===t.type;switch(e){case"change":this[r?"checkNode":"checkLeaf"](t),n(this.getPathResult());break;case"fold":r&&(t.open=!t.open,t.canOpen||"done"===t.status||n())}},p.prototype.getPathResult=function(e){var t=this;e=e||this.dataStore;var n=[],r=e.node,a=e.branches,o=e.leafs;e.path;return r.checked?n.push(e.path):(o.forEach(function(e){var t=e.checked,r=e.path;t&&n.push(r)}),a.forEach(function(e){d.apply(n,t.getPathResult(e))})),n},p.prototype.raw=function(){return r.raw(this.dataStore,this.conf)};var v={template:'<li class="v-node" :key="data.level"><i class="fa" :class="icon" @click="notify(\'unfold\')"></i> <span @click="notify(\'change\')"><i class="fa" :class="[ data.checked ? \'fa-check-square-o\' : \'fa-square-o\' ]"></i> {{data.name}}</span></li>',name:"v-node",mixins:[a],props:{data:{type:Object,required:!0},uid:{type:[String,Number],required:!0}},computed:{icon:function(){var e=this.data,t="loading"===e.status,n=e.canOpen&&e.open,r=!e.canOpen&&"done"===e.status;return{"fa-spinner cursor-progress":t,"fa-folder-open-o":!t&&n,"fa-folder-o":!t&&!n,"cursor-no-ops":r}}}},b={template:'<li class="v-leaf" @click="notify(\'change\')" :key="data.level"><i class="fa" :class="[ data.checked ? \'fa-check-square-o\' : \'fa-square-o\' ]"></i> {{data.name}}</li>',name:"v-leaf",mixins:[a],props:{data:{type:Object,required:!0},uid:{type:[String,Number],required:!0}}},m={template:'<li :key="node.level" class="v-branch"><ul class="v-branch-body"><v-node :data="node" :uid="uid"></v-node><v-branch v-show="node.open" v-for="branch in branches" :data="branch" :uid="uid"></v-branch><v-leaf v-show="node.open" v-for="leaf in leafs" :data="leaf" :uid="uid"></v-leaf></ul></li>',name:"v-branch",mixins:[a],props:{data:{type:Object,required:!0},uid:{type:[String,Number],required:!0}},components:{"v-node":v,"v-leaf":b},computed:{branches:function(){return this.data.branches},leafs:function(){return this.data.leafs},node:function(){return this.data.node}}},y={template:'<ul class="v-branch-body"><v-node :data="node" :uid="uid"></v-node><v-branch v-show="node.open" v-for="branch in branches" :data="branch" :uid="uid"></v-branch><v-leaf v-show="node.open" v-for="leaf in leafs" :data="leaf" :uid="uid"></v-leaf></ul>',name:"v-tree",mixins:[a],props:{store:{type:Object,required:!0},uid:{type:[String,Number],required:!0}},components:{"v-node":v,"v-leaf":b,"v-branch":m},computed:{root:function(){return this.store.dataStore},branches:function(){return this.root.branches},leafs:function(){return this.root.leafs},node:function(){return this.root.node}}},g={},j={template:'<v-tree :store="store" :uid="uid"></v-tree>',name:"v-folder",mixins:[a],props:{data:Object,uid:{type:[String,Number],required:!0},ajax:Object,conf:Object},components:{"v-tree":y},data:function(){return{store:new p(this.data,this.conf)}},methods:{request:function(e,t){if(!this.ajax)return t("ajax:false");var n=this.conf||{},r=n.branch||"dirs",a=(n.leaf||"files",n.node||"name"),o=this.ajax,i=(o.url,o.method),c=o.data,s=o.params,f=o.pathAs,u="GET"===i.toUpperCase();u?(o.params=s||{},o.params[f]=e.path):(o.data=c||{},o.data[f]=e.path),this.$http(o).then(function(e){var n=e.data;n[r]=n[r].map(function(e){return t={},t[a]=e,t;var t}),t(null,n)}).catch(function(e){t(e)})}},created:function(){var e=this,t=this.uid;if(t in g)throw"each <v-folder> instance must get an unique `uid` property";g[t]=null,this.listen("change",function(t){e.store.commit("change",t,function(t){e.$emit("change",t)})}),this.listen("unfold",function(t){e.store.commit("fold",t,function(){t.status="loading",e.request(t,function(n,r){n?t.status="empty":e.store.merge(r,t)})})})}},O=n(function(e,t){!function(t,n){e.exports=n()}(f,function(){function e(e){var t=e.split("."),n=t.splice(0,2);return n.push(t.join(".")),n}function t(e){return isNaN(Number(e))?e:Number(e)}function n(e){if("string"!=typeof e)throw new TypeError("Invalid argument expected string");if(!r.test(e))throw new Error("Invalid argument not valid semver")}var r=/^v?(?:0|[1-9]\d*)(\.(?:[x*]|0|[1-9]\d*)(\.(?:[x*]|0|[1-9]\d*)(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,a=/-([0-9A-Za-z-.]+)/;return function(r,o){[r,o].forEach(n);for(var i=e(r),c=e(o),s=0;s<3;s++){var f=parseInt(i[s]||0,10),u=parseInt(c[s]||0,10);if(f>u)return 1;if(u>f)return-1}if([i[2],c[2]].every(a.test.bind(a))){var d=a.exec(i[2])[1].split(".").map(t),l=a.exec(c[2])[1].split(".").map(t);for(s=0;s<Math.max(d.length,l.length);s++){if(void 0===d[s]||"string"==typeof l[s]&&"number"==typeof d[s])return-1;if(void 0===l[s]||"string"==typeof d[s]&&"number"==typeof l[s])return 1;if(d[s]>l[s])return 1;if(l[s]>d[s])return-1}}else if([i[2],c[2]].some(a.test.bind(a)))return a.test(i[2])?-1:1;return 0}})}),k=function(){var e=function(e,t){return O(e,t)>=0};if(!e(Vue.version,"2.0.0"))throw"This module can only supports vue@2!"},w=function(){var e=new Vue,t=Vue.prototype;t.___von=function(t,n){var r=this.uid,a=function(e){r===e.uid&&n&&n(e.data)};e.$on("#"+r+"@"+t,a)},t.___vemit=function(t,n){var r=this.uid;e.$emit("#"+r+"@"+t,{data:n,uid:r})},t.___voff=function(t,n){var r=this.uid;if(t)e.$off("#"+r+"@"+t,n);else{r="#"+r+"@";var a=(r.length,Object.keys(e._events)),o=a.filter(function(e){return 0===e.indexOf(r)});o.forEach(function(t){e.$off(t,n)})}}};return j.install=function(e){k(e),w(e),e.component(j.name,j)},j});
//# sourceMappingURL=bundle.common.js.map
