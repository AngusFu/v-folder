!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.VFolder=t()}(this,function(){"use strict";function e(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function t(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var a=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"!==a.join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}function n(e,t,a,r){void 0===e&&(e={});var o=t.node,c=t.branch,s=t.leaf,i=t.check,u=t.open,h=e[o]||"/",f=e[c]||[],d=e[s]||[],l=f.length>0||d.length>0;r=r||"/"+h,f=f.map(function(e,o){return n(e,t,a+"."+o,r+"/"+e.name)}),d=d.map(function(e,t){return{name:e,type:"leaf",check:i,level:a+"."+t,path:r+"/"+e}});var p=l?"filled":"empty";return{name:h,type:"branch",level:a,path:r,node:{name:h,open:u,canOpen:l,check:i,level:a,path:r,type:"node",status:p},branches:f,leafs:d}}var a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,c=t()?Object.assign:function(t,n){for(var c,s,i=arguments,u=e(t),h=1;h<arguments.length;h++){c=Object(i[h]);for(var f in c)r.call(c,f)&&(u[f]=c[f]);if(a){s=a(c);for(var d=0;d<s.length;d++)o.call(c,s[d])&&(u[s[d]]=c[s[d]])}}return u},s=function e(t){var n={};return t&&"object"==typeof t?(t instanceof Array&&(n=[]),Object.keys(t).forEach(function(a){"object"==typeof t[a]?n[a]=e(t[a]):n[a]=t[a]}),n):t},i=[].push,u=function(e){return e},h={node:"name",branch:"dirs",leaf:"files",open:!1,check:-1},f=function(e,t){var a=e.path||e.name,r=a.split("/").filter(function(e){return!!e}).slice(-1)[0]||e.name;e.name=r,this.conf=c({},t,h),this.dataStore=n(e,this.conf,"0",a)};f.prototype.replace=function(e){this.dataStore=e},f.prototype.findParentBranch=function(e){void 0===e&&(e="");var t=e.length,n=this.dataStore;if(t<=1)return null;for(var a=e.split(".").slice(1,-1),r=0;n&&(r=a.shift());)n=n.branches[r];return n},f.prototype.findCurrentBranch=function(e){void 0===e&&(e="");for(var t=e.split(".").slice(1),n=0,a=this.dataStore;a&&(n=t.shift());)a=a.branches[n];return a},f.prototype.checkBranchAscendents=function(e,t){if(e){var n=e.branches,a=e.leafs,r=e.node,o=e.level,c=0;switch(t){case 1:var s=!n.length||!n.some(function(e){return e.node.check<1}),i=!a.length||!a.some(function(e){return e.check<1});c=s&&i?1:0;break;case 0:c=0;break;case-1:var u=!n.length||!n.some(function(e){return e.node.check>-1}),h=!a.length||!a.some(function(e){return e.check>-1});c=u&&h?-1:0}r.check=c,this.checkBranchAscendents(this.findParentBranch(o),c)}},f.prototype.checkBranchDescendents=function(e,t){var n=this;e.node.check=t,t&&(e.leafs.forEach(function(e){return e.check=t}),e.branches.forEach(function(e){e.node.check=t,n.checkBranchDescendents(e,t)}))},f.prototype.checkNode=function(e){var t=this.findCurrentBranch(e.level),n=t.node.check,a=n<1?1:-1;this.checkBranchDescendents(t,a),this.checkBranchAscendents(this.findParentBranch(t.level),a)},f.prototype.checkLeaf=function(e){var t=this.findParentBranch(e.level),n=-1*e.check;e.check=n,this.checkBranchAscendents(t,n)},f.prototype.merge=function(e,t){void 0===e&&(e={}),void 0===t&&(t={level:"0",path:""});var a=t.level,r=t.path,o=t.check,c=a.split(".").slice(1),i=n(e,this.conf,a,r);if(i.node.open=!0,i.node.check=o,i.node.status="done",0===c.length)this.replace(i);else{for(var u=s(this.dataStore),h=u,f=c.pop(),d=0;d=c.shift();)h=h.branches[d];h.branches.splice(f,1,i),h.node.canOpen=!0,this.replace(u)}this.checkBranchDescendents(i,o)},f.prototype.commit=function(e,t,n){void 0===n&&(n=u);var a="node"===t.type;switch(e){case"change":this[a?"checkNode":"checkLeaf"](t),n(this.getPathResult());break;case"fold":a&&(t.open=!t.open,t.canOpen||"done"===t.status||n())}},f.prototype.getPathResult=function(e){var t=this;e=e||this.dataStore;var n=[],a=e.node,r=e.branches,o=e.leafs;e.path;return a.check>0?n.push(e.path):(o.forEach(function(e){var t=e.check,a=e.path;t>0&&n.push(a)}),r.forEach(function(e){i.apply(n,t.getPathResult(e))})),n},f.prototype.raw=function(){return n.raw(this.dataStore,this.conf)};var d={methods:{notify:function(e){this.___vemit(e,this.data)},listen:function(e,t){this.___von(e,function(e){t(e)})}},destroyed:function(){this.___voff()}},l=["fa-square-o","fa-minus-square-o","fa-check-square-o"],p={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{key:e.data.level,staticClass:"v-node"},[n("i",{staticClass:"fa",class:e.folderClass,on:{click:function(t){e.notify("unfold")}}}),e._v(" "),n("span",{on:{click:function(t){e.notify("change")}}},[n("i",{staticClass:"fa",class:e.checkboxClass}),e._v(" "+e._s(e.data.name))])])},staticRenderFns:[],name:"v-node",mixins:[d],props:{data:{type:Object,required:!0},uid:{type:[String,Number],required:!0}},computed:{folderClass:function(){var e=this.data,t="loading"===e.status,n=e.canOpen&&e.open,a=!e.canOpen&&"done"===e.status;return{"fa-spinner cursor-progress":t,"fa-folder-open-o":!t&&n,"fa-folder-o":!t&&!n,"cursor-no-ops":a}},checkboxClass:function(){return l[this.data.check+1]}}},v=["fa-square-o","fa-minus-square-o","fa-check-square-o"],m={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{key:e.data.level,staticClass:"v-leaf",on:{click:function(t){e.notify("change")}}},[n("i",{staticClass:"fa",class:e.className}),e._v(" "+e._s(e.data.name))])},staticRenderFns:[],name:"v-leaf",mixins:[d],props:{data:{type:Object,required:!0},uid:{type:[String,Number],required:!0}},computed:{className:function(){return v[this.data.check+1]}}},b={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{key:e.node.level,staticClass:"v-branch"},[n("ul",{staticClass:"v-branch-body"},[n("v-node",{attrs:{data:e.node,uid:e.uid}}),e._l(e.branches,function(t){return n("v-branch",{directives:[{name:"show",rawName:"v-show",value:e.node.open,expression:"node.open"}],attrs:{data:t,uid:e.uid}})}),e._l(e.leafs,function(t){return n("v-leaf",{directives:[{name:"show",rawName:"v-show",value:e.node.open,expression:"node.open"}],attrs:{data:t,uid:e.uid}})})],2)])},staticRenderFns:[],name:"v-branch",mixins:[d],props:{data:{type:Object,required:!0},uid:{type:[String,Number],required:!0}},components:{"v-node":p,"v-leaf":m},computed:{branches:function(){return this.data.branches},leafs:function(){return this.data.leafs},node:function(){return this.data.node}}},y={},k={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"v-branch-body"},[n("v-node",{attrs:{data:e.node,uid:e.uid}}),e._l(e.branches,function(t){return n("v-branch",{directives:[{name:"show",rawName:"v-show",value:e.node.open,expression:"node.open"}],attrs:{data:t,uid:e.uid}})}),e._l(e.leafs,function(t){return n("v-leaf",{directives:[{name:"show",rawName:"v-show",value:e.node.open,expression:"node.open"}],attrs:{data:t,uid:e.uid}})})],2)},staticRenderFns:[],name:"v-folder",mixins:[d],props:{data:Object,uid:{type:[String,Number],required:!0},ajax:Object,conf:Object},components:{"v-node":p,"v-leaf":m,"v-branch":b},data:function(){return{store:new f(this.data,this.conf)}},computed:{root:function(){return this.store.dataStore},branches:function(){return this.root.branches},leafs:function(){return this.root.leafs},node:function(){return this.root.node}},methods:{request:function(e,t){if(!this.ajax)return t("ajax:false");var n=this.conf||{},a=n.branch||"dirs",r=(n.leaf||"files",n.node||"name"),o=this.ajax,c=(o.url,o.method),s=o.data,i=o.params,u=o.pathAs,h=o.headers,f="GET"===c.toUpperCase();f?(o.params=i||{},o.params[u]=e.path):(o.data=s||{},o.data[u]=e.path),o.headers=h||{},this.$http(o).then(function(e){return e.data}).then(function(n){n[r]=e.name,n[a]=n[a].map(function(e){return t={},t[r]=e,t;var t}),t(null,n)}).catch(function(e){return t(e)})}},created:function(){var e=this,t=this.uid;if(t in y)throw"each <v-folder> instance must get an unique `uid` property";y[t]=null,this.listen("change",function(t){e.store.commit("change",t,function(t){return e.$emit("change",t)})}),this.listen("unfold",function(t){e.store.commit("fold",t,function(){t.status="loading",e.request(t,function(n,a){n?t.status="empty":e.store.merge(a,t)})})})}},g=function(e){var t=new e,n=e.prototype;n.___von=function(e,n){var a=this.uid,r=function(e){a===e.uid&&n&&n(e.data)};t.$on("#"+a+"@"+e,r)},n.___vemit=function(e,n){var a=this.uid;t.$emit("#"+a+"@"+e,{data:n,uid:a})},n.___voff=function(e,n){var a=this.uid;if(e)t.$off("#"+a+"@"+e,n);else{a="#"+a+"@";var r=(a.length,Object.keys(t._events)),o=r.filter(function(e){return 0===e.indexOf(a)});o.forEach(function(e){t.$off(e,n)})}}};return k.install=function(e){var t=e.version.split("."),n=t[0],a=t[1],r=t[2];if(n>2||2===n&&(a>1||1===a&&r>=5))throw"You should at least get Vue.js@2.1.5.";g(e),e.component(k.name,k)},k});
//# sourceMappingURL=build.js.map
