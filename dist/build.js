!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.VFolder=e()}}(function(){return function e(t,n,r){function o(i,s){if(!n[i]){if(!t[i]){var c="function"==typeof require&&require;if(!s&&c)return c(i,!0);if(a)return a(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var f=n[i]={exports:{}};t[i][0].call(f.exports,function(e){var n=t[i][1][e];return o(n?n:e)},f,f.exports,e,t,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(e,t,n){function r(){}var o=n.cache={};n.insert=function(e){if(o[e])return r;o[e]=!0;var t=document.createElement("style");return t.setAttribute("type","text/css"),"textContent"in t?t.textContent=e:t.styleSheet.cssText=e,document.getElementsByTagName("head")[0].appendChild(t),function(){document.getElementsByTagName("head")[0].removeChild(t),o[e]=!1}}},{}],2:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("./index.vue"),i=r(a),s=e("./install");i.default.install=function(e){var t=e.version.split("."),n=o(t,3),r=n[0],a=n[1],c=n[2];if(r>2||2===r&&(a>1||1===a&&c>=5))throw"You should at least get Vue.js@2.1.5.";(0,s.eventMix)(e),e.component(i.default.name,i.default)},n.default=i.default},{"./index.vue":3,"./install":4}],3:[function(e,t,n){e("vueify/lib/insert-css").insert(".v-branch-body{padding:0;font-size:16px;color:#666;list-style:none}.v-branch-body>.v-branch{padding-left:20px}.v-branch>ul{margin:0;padding:0;list-style:none}.v-leaf,.v-node{height:1.5em;line-height:1.5em;padding:0 0 0 20px;vertical-align:middle;overflow:hidden}.v-leaf{margin:0 0 0 20px}.v-leaf>.fa,.v-node>.fa,.v-node>span>.fa{float:left;width:20px;height:1.5em;line-height:1.5em;color:#0d83e6;text-align:center;cursor:pointer}.v-leaf>span,.v-node>span{float:left;cursor:pointer}.v-leaf .fa:hover,.v-node .fa:hover{color:#0c71c5}.v-node>.cursor-no-ops{cursor:not-allowed}.v-node>.cursor-progress{cursor:progress}");!function(){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./store"),a=t(o),i=e("./mixin"),s=t(i),c=e("./v-node.vue"),u=t(c),f=e("./v-leaf.vue"),l=t(f),d=e("./v-branch.vue"),h=t(d),v=0;n.default={name:"v-folder",mixins:[s.default],props:{data:Object,ajax:Object,conf:Object},components:{"v-node":u.default,"v-leaf":l.default,"v-branch":h.default},watch:{data:function(e,t){var n=this.conf&&this.conf.node||"name";e[n]!==t[n]&&(this.store=new a.default(e,this.conf))}},data:function(){return{uid:v++,store:new a.default(this.data,this.conf)}},computed:{root:function(){return this.store.dataStore},branches:function(){return this.root.branches},leafs:function(){return this.root.leafs},node:function(){return this.root.node}},methods:{resTransform:function(e,t){var n=this.conf||{},o=n.branch||"dirs",a=(n.leaf||"files",n.node||"name");return e[a]=t.name,e[o]=e[o].map(function(e){return r({},a,e)}),e},getReqConf:function(e){var t=this.ajax||{},n=(t.url,t.method),r=t.data,o=t.params,a=t.pathAs,i=t.headers;return n||"GET"===n.toUpperCase()?(t.params=o||{},t.params[a]=e.path):(t.data=r||{},t.data[a]=e.path),t.method=n||"GET",t.headers=i||{},t},request:function(e){var t=this;if(!this.ajax)return Promise.reject("ajax:false");var n=this.ajax.process||function(e){return e};return this.$http(this.getReqConf(e)).then(function(r){var o=n(r.data);return t.resTransform(o,e)})}},created:function(){var e=this;this.listen("change",function(t){e.store.commit("change",t).then(function(t){return e.$emit("change",t)})}),this.listen("unfold",function(t){return t.open&&t.canOpen?void(t.open=!t.open):void e.store.commit("unfold",t).then(function(){e.request(t).then(function(n){if(!n)throw"empty";e.store.merge(n,t)}).catch(function(e){t.status="empty",window.console&&console.error(e)})}).catch(function(e){return t.status="done"})})},destroyed:function(){this.distroy()}}}(),t.exports.__esModule&&(t.exports=t.exports.default);var r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"v-branch-body"},[n("v-node",{attrs:{data:e.node,uid:e.uid}}),e._v(" "),e._l(e.branches,function(t){return n("v-branch",{directives:[{name:"show",rawName:"v-show",value:e.node.open,expression:"node.open"}],attrs:{data:t,uid:e.uid}})}),e._v(" "),e._l(e.leafs,function(t){return n("v-leaf",{directives:[{name:"show",rawName:"v-show",value:e.node.open,expression:"node.open"}],attrs:{data:t,uid:e.uid}})})],2)},r.staticRenderFns=[]},{"./mixin":5,"./store":6,"./v-branch.vue":10,"./v-leaf.vue":11,"./v-node.vue":12,"vueify/lib/insert-css":1}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.eventMix=function(e){var t=new e,n=e.prototype;n.___von=function(e,n){var r=this.uid,o=function(e){r===e.uid&&n&&n(e.data)};t.$on("#"+r+"@"+e,o)},n.___vemit=function(e,n){var r=this.uid;t.$emit("#"+r+"@"+e,{data:n,uid:r})},n.___voff=function(e,n){var r=this.uid;if(e)t.$off("#"+r+"@"+e,n);else{r="#"+r+"@";var o=(r.length,Object.keys(t._events)),a=o.filter(function(e){return 0===e.indexOf(r)});a.forEach(function(e){t.$off(e,n)})}}}},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={methods:{notify:function(e){this.___vemit(e,this.data)},listen:function(e,t){this.___von(e,function(e){t(e)})},distroy:function(){this.___voff()}}}},{}],6:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./utils/object-assign"),s=r(i),c=e("./utils/deepCopy"),u=r(c),f=e("./transform"),l=r(f),d=[].push,h={node:"name",branch:"dirs",leaf:"files",open:!1,check:-1},v=function(){function e(t,n){o(this,e),this.conf=(0,s.default)({},h,n);var r=t.path||t[this.conf.node]||"/",a=r.split("/").filter(function(e){return!!e}).slice(-1)[0]||t.name;t.name=a,this.dataStore=(0,l.default)(t,this.conf,"0",r)}return a(e,[{key:"replace",value:function(e){this.dataStore=e}},{key:"findParentBranch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.length,n=this.dataStore;if(t<=1)return null;for(var r=e.split(".").slice(1,-1),o=0;n&&(o=r.shift());)n=n.branches[o];return n}},{key:"findCurrentBranch",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.split(".").slice(1),n=0,r=this.dataStore;r&&(n=t.shift());)r=r.branches[n];return r}},{key:"checkBranchAscendents",value:function(e,t){if(e){var n=e.branches,r=e.leafs,o=e.node,a=e.level,i=0;switch(t){case 1:var s=!n.length||!n.some(function(e){return e.node.check<1}),c=!r.length||!r.some(function(e){return e.check<1});i=s&&c?1:0;break;case 0:i=0;break;case-1:var u=!n.length||!n.some(function(e){return e.node.check>-1}),f=!r.length||!r.some(function(e){return e.check>-1});i=u&&f?-1:0}o.check=i,this.checkBranchAscendents(this.findParentBranch(a),i)}}},{key:"checkBranchDescendents",value:function(e,t){var n=this;e.node.check=t,t&&(e.leafs.forEach(function(e){return e.check=t}),e.branches.forEach(function(e){e.node.check=t,n.checkBranchDescendents(e,t)}))}},{key:"checkNode",value:function(e){var t=this.findCurrentBranch(e.level),n=t.node.check,r=n<1?1:-1;this.checkBranchDescendents(t,r),this.checkBranchAscendents(this.findParentBranch(t.level),r)}},{key:"checkLeaf",value:function(e){var t=this.findParentBranch(e.level),n=-1*e.check;e.check=n,this.checkBranchAscendents(t,n)}},{key:"merge",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{level:"0",path:""},n=t.level,r=t.path,o=t.check,a=n.split(".").slice(1),i=(0,l.default)(e,this.conf,n,r);if(i.node.open=!0,i.node.check=o,i.node.status="done",0===a.length)this.replace(i);else{for(var s=(0,u.default)(this.dataStore),c=s,f=a.pop(),d=0;d=a.shift();)c=c.branches[d];c.branches.splice(f,1,i),c.node.canOpen=!0,this.replace(s)}this.checkBranchDescendents(i,o)}},{key:"commit",value:function(e,t){var n=this;return new Promise(function(r,o){var a="node"===t.type;return"change"===e?(n[a?"checkNode":"checkLeaf"](t),r(n.getPathResult())):void("unfold"===e&&a&&(t.open=!t.open,t.canOpen||"done"===t.status?o():(t.status="loading",r())))})}},{key:"getPathResult",value:function(e){var t=this;e=e||this.dataStore;var n=[],r=e,o=r.node,a=r.branches,i=r.leafs;r.path;return o.check>0?n.push(e.path):(i.forEach(function(e){var t=e.check,r=e.path;t>0&&n.push(r)}),a.forEach(function(e){d.apply(n,t.getPathResult(e))})),n}},{key:"raw",value:function(){return l.default.raw(this.dataStore,this.conf)}}]),e}();n.default=v},{"./transform":7,"./utils/deepCopy":8,"./utils/object-assign":9}],7:[function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";o=o.replace(/^\s*\/+/,"/");var a=t.node,i=t.branch,s=t.leaf,c=t.check,u=t.open,f=e[a]||"/",l=e[i]||[],d=e[s]||[],h=l.length>0||d.length>0;o||(o="/"===f?f:"/"+f),l=l.map(function(e,i){if("string"==typeof e){var s={};s[a]=e,e=s}return r(e,t,n+"."+i,o+"/"+e[a])}),d=d.map(function(e,t){return{name:e,type:"leaf",check:c,level:n+"."+t,path:o+"/"+e}});var v=h?"filled":"empty";return{name:f,type:"branch",level:n,path:o,node:{name:f,open:"0"==n||u,canOpen:h,check:c,level:n,path:o,type:"node",status:v},branches:l,leafs:d}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=r},{}],8:[function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(null===e||"object"!==("undefined"==typeof e?"undefined":o(e)))return e;var n=find(t,function(t){return t.original===e});if(n)return n.copy;var a=Array.isArray(e)?[]:{};return t.push({original:e,copy:a}),Object.keys(e).forEach(function(n){a[n]=r(e[n],t)}),a}Object.defineProperty(n,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.default=r},{}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),"function"!=typeof Object.assign&&(Object.assign=function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),r=1;r<arguments.length;r++){var o=arguments[r];if(null!=o)for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(n[a]=o[a])}return n}),n.default=Object.assign},{}],10:[function(e,t,n){!function(){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./mixin"),o=t(r),a=e("./v-leaf.vue"),i=t(a),s=e("./v-node.vue"),c=t(s);n.default={name:"v-branch",mixins:[o.default],props:{data:{type:Object,required:!0},uid:{type:[String,Number],required:!0}},components:{"v-node":c.default,"v-leaf":i.default}}}(),t.exports.__esModule&&(t.exports=t.exports.default);var r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{key:e.data.node.level,staticClass:"v-branch"},[n("ul",{staticClass:"v-branch-body"},[n("v-node",{attrs:{data:e.data.node,uid:e.uid}}),e._v(" "),e._l(e.data.branches,function(t){return n("v-branch",{directives:[{name:"show",rawName:"v-show",value:e.data.node.open,expression:"data.node.open"}],attrs:{data:t,uid:e.uid}})}),e._v(" "),e._l(e.data.leafs,function(t){return n("v-leaf",{directives:[{name:"show",rawName:"v-show",value:e.data.node.open,expression:"data.node.open"}],attrs:{data:t,uid:e.uid}})})],2)])},r.staticRenderFns=[]},{"./mixin":5,"./v-leaf.vue":11,"./v-node.vue":12}],11:[function(e,t,n){!function(){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./mixin"),o=t(r),a=["fa-square-o","fa-minus-square-o","fa-check-square-o"];n.default={name:"v-leaf",mixins:[o.default],props:{data:{type:Object,required:!0},uid:{type:[String,Number],required:!0}},computed:{className:function(){return a[this.data.check+1]}}}}(),t.exports.__esModule&&(t.exports=t.exports.default);var r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{key:e.data.level,staticClass:"v-leaf",on:{click:function(t){e.notify("change")}}},[n("i",{staticClass:"fa",class:e.className}),e._v(" "),n("span",[e._v(e._s(e.data.name))])])},r.staticRenderFns=[]},{"./mixin":5}],12:[function(e,t,n){!function(){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./mixin"),o=t(r),a=["fa-square-o","fa-minus-square-o","fa-check-square-o"];n.default={name:"v-node",mixins:[o.default],props:{data:{type:Object,required:!0},uid:{type:[String,Number],required:!0}},computed:{folderClass:function(){var e=this.data,t="loading"===e.status,n=e.canOpen&&e.open,r=!e.canOpen&&"done"===e.status;return{"fa-spinner cursor-progress":t,"fa-folder-open-o":!t&&n,"fa-folder-o":!t&&!n,"cursor-no-ops":r}},checkboxClass:function(){return a[this.data.check+1]}}}}(),t.exports.__esModule&&(t.exports=t.exports.default);var r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{key:e.data.level,staticClass:"v-node"},[n("i",{staticClass:"fa",class:e.folderClass,on:{click:function(t){e.notify("unfold")}}}),e._v(" "),n("span",{on:{click:function(t){e.notify("change")}}},[n("i",{staticClass:"fa",class:e.checkboxClass}),e._v("\n    "+e._s(e.data.name)+"\n  ")])])},r.staticRenderFns=[]},{"./mixin":5}]},{},[2])(2)});
